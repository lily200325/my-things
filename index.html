<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>my things</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="search-bar">
            <input type="text" id="searchInput" placeholder="æœç´¢..." onkeypress="handleSearch(event)">
            <div class="action-buttons">
                <button class="export-btn" onclick="exportAllData()">å¯¼å‡º</button>
                <button onclick="importAllData()">å¯¼å…¥</button>
            </div>
        </div>
        <div class="header">
            <h1>æˆ‘çš„ç‰©å“ç®¡ç†</h1>
        </div>
        <div class="category-list">
            <a href="wear/index.html" class="category-item">
                <div class="category-content">
                    <span class="emoji">ğŸ‘—</span>
                    <span class="category-name">ç©¿æˆ´ç±»</span>
                </div>
            </a>
            <a href="bodycare/index.html" class="category-item">
                <div class="category-content">
                    <span class="emoji">ğŸ§´</span>
                    <span class="category-name">èº«ä½“æŠ¤ç†ç±»</span>
                </div>
            </a>
            <a href="daily/index.html" class="category-item">
                <div class="category-content">
                    <span class="emoji">ğŸ </span>
                    <span class="category-name">æ—¥ç”¨å“ç±»</span>
                </div>
            </a>
            <a href="office/index.html" class="category-item">
                <div class="category-content">
                    <span class="emoji">ğŸ“š</span>
                    <span class="category-name">åŠå…¬ç”¨å“ç±»</span>
                </div>
            </a>
            <a href="hobby/index.html" class="category-item">
                <div class="category-content">
                    <span class="emoji">ğŸ¨</span>
                    <span class="category-name">å…´è¶£çˆ±å¥½ç±»</span>
                </div>
            </a>
            <a href="growth/index.html" class="category-item">
                <div class="category-content">
                    <span class="emoji">ğŸŒ±</span>
                    <span class="category-name">éŸ­èœæˆé•¿æ—¥å¿—</span>
                </div>
            </a>
        </div>
    </div>

    <!-- å¯¼å‡ºæ•°æ®å¼¹çª— -->
    <div class="modal" id="exportModal">
        <div class="modal-content">
            <h3>å¯¼å‡ºæ•°æ®</h3>
            <textarea id="exportData" readonly></textarea>
            <div class="modal-buttons">
                <button class="copy-btn" onclick="copyExportData()">å¤åˆ¶</button>
                <button class="close-btn" onclick="closeModal()">å…³é—­</button>
            </div>
        </div>
    </div>

    <script>
        // å®šä¹‰æ‰€æœ‰å¯èƒ½çš„localStorageé”®
        const allStorageKeys = [
            // ç©¿æˆ´ç±»
            'wear_winter', 'wear_summer', 'wear_spring_autumn',
            'wear_shoes', 'wear_underwear',
            'wear_jewelry_earrings', 'wear_jewelry_necklace', 
            'wear_jewelry_bracelet', 'wear_jewelry_ring', 'wear_jewelry_brooch',
            'wear_accessories',
            
            // èº«ä½“æŠ¤ç†ç±»
            'bodycare_hand', 'bodycare_lip', 'bodycare_face',
            
            // æ—¥ç”¨å“ç±»
            'daily_kitchen', 'daily_winter', 'daily_summer',
            'daily_card', 'daily_container', 'daily_souvenir',
            'daily_other',
            
            // åŠå…¬ç”¨å“ç±»
            'office_pen', 'office_other',
            
            // å…´è¶£çˆ±å¥½ç±»
            'hobby_photo', 'hobby_photo_tools', 'hobby_photo_props',
            'hobby_photo_stand', 'hobby_photo_light',
            'hobby_sewing', 'hobby_sports', 'hobby_music',
            'hobby_drawing', 'hobby_calligraphy',
            
            // æˆé•¿æ—¥å¿—
            'growth'
        ];

        // å¯¼å‡ºæ‰€æœ‰æ•°æ®
        function exportAllData() {
            const allData = {};
            let hasData = false;
            
            console.log('å¼€å§‹å¯¼å‡ºæ•°æ®...');
            console.log('localStorage æ€»æ¡ç›®æ•°:', localStorage.length);
            
            // æ”¶é›†æ‰€æœ‰localStorageä¸­çš„æ•°æ®
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                console.log('æ­£åœ¨å¤„ç†é”®:', key);
                
                // ä¿®æ”¹åŒ¹é…è§„åˆ™ï¼Œæ¥å—æ‰€æœ‰Itemsç»“å°¾çš„é”®å
                if (key.endsWith('Items') || key === 'growth' || 
                    key.match(/^(wear|bodycare|daily|office|hobby)_/)) {
                    try {
                        const data = localStorage.getItem(key);
                        console.log(`é”® ${key} çš„åŸå§‹æ•°æ®:`, data);
                        
                        if (data) {
                            const parsedData = JSON.parse(data);
                            console.log(`é”® ${key} çš„è§£æåæ•°æ®:`, parsedData);
                            
                            // æ¥å—ä»»ä½•æœ‰æ•ˆçš„æ•°ç»„æ•°æ®
                            if (Array.isArray(parsedData)) {
                                allData[key] = parsedData;
                                hasData = true;
                                console.log(`æˆåŠŸæ·»åŠ é”® ${key} çš„æ•°æ®`);
                            } else {
                                console.log(`è·³è¿‡é”® ${key} - æ•°æ®ä¸æ˜¯æ•°ç»„æ ¼å¼`);
                            }
                        }
                    } catch (e) {
                        console.error(`å¤„ç†é”® ${key} æ—¶å‡ºé”™:`, e);
                    }
                } else {
                    console.log(`è·³è¿‡é”® ${key} - ä¸ç¬¦åˆå‘½åè§„åˆ™`);
                }
            }
            
            console.log('æœ€ç»ˆæ”¶é›†çš„æ•°æ®:', allData);
            
            if (!hasData) {
                alert('æ²¡æœ‰æ‰¾åˆ°å¯å¯¼å‡ºçš„æ•°æ®');
                return;
            }

            // æ˜¾ç¤ºå¯¼å‡ºæ•°æ®å¼¹çª—
            const modal = document.getElementById('exportModal');
            const textarea = document.getElementById('exportData');
            textarea.value = JSON.stringify(allData, null, 2);
            modal.style.display = 'flex';
        }

        // å¯¼å…¥æ‰€æœ‰æ•°æ®
        function importAllData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importedData = JSON.parse(e.target.result);
                        
                        // ä¿®æ”¹éªŒè¯è§„åˆ™ï¼Œæ¥å—æ‰€æœ‰Itemsç»“å°¾çš„é”®å
                        Object.keys(importedData).forEach(key => {
                            if (!key.endsWith('Items') && 
                                !key.match(/^(wear|bodycare|daily|office|hobby)_/) && 
                                key !== 'growth') {
                                throw new Error(`æ— æ•ˆçš„æ•°æ®é”®: ${key}`);
                            }
                        });
                        
                        // å¯¼å…¥æ•°æ®
                        Object.keys(importedData).forEach(key => {
                            localStorage.setItem(key, JSON.stringify(importedData[key]));
                        });
                        
                        alert('æ•°æ®å¯¼å…¥æˆåŠŸï¼');
                    } catch (error) {
                        alert('å¯¼å…¥å¤±è´¥ï¼š' + error.message);
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }

        // å¤åˆ¶å¯¼å‡ºæ•°æ®
        function copyExportData() {
            const textarea = document.getElementById('exportData');
            textarea.select();
            document.execCommand('copy');
            alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
        }

        // å…³é—­å¼¹çª—
        function closeModal() {
            document.getElementById('exportModal').style.display = 'none';
        }

        // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­å¼¹çª—
        window.onclick = function(event) {
            const modal = document.getElementById('exportModal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }

        // å¤„ç†æœç´¢
        function handleSearch(event) {
            if (event.key === 'Enter') {
                const searchTerm = document.getElementById('searchInput').value.toLowerCase();
                let foundItems = [];
                
                // æœç´¢æ‰€æœ‰localStorageä¸­çš„æ•°æ®
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key.match(/^(wear|bodycare|daily|office|hobby|growth)_/)) {
                        try {
                            const data = localStorage.getItem(key);
                            if (data) {
                                const parsedData = JSON.parse(data);
                                const items = parsedData.items || parsedData;
                                if (Array.isArray(items)) {
                                    const matches = items.filter(item => 
                                        item.location && item.location.toLowerCase().includes(searchTerm)
                                    );
                                    if (matches.length > 0) {
                                        foundItems.push({
                                            key: key,
                                            items: matches
                                        });
                                    }
                                }
                            }
                        } catch (e) {
                            console.error(`Error searching in ${key}:`, e);
                        }
                    }
                }

                if (foundItems.length > 0) {
                    let message = 'æ‰¾åˆ°ä»¥ä¸‹åŒ¹é…é¡¹ï¼š\n\n';
                    foundItems.forEach(category => {
                        const categoryName = getCategoryName(category.key);
                        message += `${categoryName}ï¼š\n`;
                        category.items.forEach(item => {
                            message += `- ${item.location}\n`;
                        });
                        message += '\n';
                    });
                    alert(message);
                } else {
                    alert('æœªæ‰¾åˆ°åŒ¹é…çš„ç‰©å“');
                }
            }
        }

        // è·å–åˆ†ç±»åç§°
        function getCategoryName(key) {
            const categoryMap = {
                // ç©¿æˆ´ç±»
                'wear_winter': 'å†¬å­£æœè£…',
                'wear_summer': 'å¤å­£æœè£…',
                'wear_spring_autumn': 'æ˜¥ç§‹æœè£…',
                'wear_shoes': 'é‹å­',
                'wear_underwear': 'å†…è¡£',
                'wear_jewelry_earrings': 'è€³ç¯',
                'wear_jewelry_necklace': 'é¡¹é“¾',
                'wear_jewelry_bracelet': 'æ‰‹é“¾',
                'wear_jewelry_ring': 'æˆ’æŒ‡',
                'wear_jewelry_brooch': 'èƒ¸é’ˆ',
                'wear_accessories': 'é…é¥°',
                
                // èº«ä½“æŠ¤ç†ç±»
                'bodycare_hand': 'æŠ¤æ‰‹',
                'bodycare_lip': 'æŠ¤å”‡',
                'bodycare_face': 'æŠ¤è‚¤',
                
                // æ—¥ç”¨å“ç±»
                'daily_kitchen': 'å¨æˆ¿ç”¨å“',
                'daily_winter': 'å†¬å­£ç”¨å“',
                'daily_summer': 'å¤å­£ç”¨å“',
                'daily_card': 'å¡ç‰‡',
                'daily_container': 'æ”¶çº³ç”¨å“',
                'daily_souvenir': 'çºªå¿µå“',
                'daily_other': 'å…¶ä»–æ—¥ç”¨å“',
                
                // åŠå…¬ç”¨å“ç±»
                'office_pen': 'ç¬”ç±»',
                'office_other': 'å…¶ä»–åŠå…¬ç”¨å“',
                
                // å…´è¶£çˆ±å¥½ç±»
                'hobby_photo': 'æ‘„å½±',
                'hobby_photo_tools': 'æ‘„å½±å™¨æ',
                'hobby_photo_props': 'æ‘„å½±é“å…·',
                'hobby_photo_stand': 'æ‘„å½±æ”¯æ¶',
                'hobby_photo_light': 'æ‘„å½±ç¯å…‰',
                'hobby_sewing': 'ç¼çº«',
                'hobby_sports': 'è¿åŠ¨',
                'hobby_music': 'éŸ³ä¹',
                'hobby_drawing': 'ç»˜ç”»',
                'hobby_calligraphy': 'ä¹¦æ³•',
                
                // æˆé•¿æ—¥å¿—
                'growth': 'æˆé•¿è®°å½•'
            };
            return categoryMap[key] || key;
        }
    </script>
</body>
</html> 